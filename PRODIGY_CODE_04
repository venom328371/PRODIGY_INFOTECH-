import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from wordcloud import WordCloud, STOPWORDS

# Load dataset
file_path = "/mnt/data/twitter_training.csv"
df = pd.read_csv(file_path, header=None, names=["id", "topic", "sentiment", "tweet"])

# Drop rows with missing tweets
df = df.dropna(subset=["tweet"])

# --- 1. Sentiment distribution ---
plt.figure(figsize=(8,5))
sns.countplot(data=df, x="sentiment", order=df["sentiment"].value_counts().index, palette="viridis")
plt.title("Sentiment Distribution")
plt.xlabel("Sentiment")
plt.ylabel("Count")
plt.xticks(rotation=45)
plt.show()

# --- 2. WordCloud per sentiment ---
stopwords = set(STOPWORDS)

for sentiment in df["sentiment"].unique():
    text = " ".join(df[df["sentiment"] == sentiment]["tweet"].astype(str).values)
    wc = WordCloud(width=800, height=400, background_color="white", stopwords=stopwords).generate(text)

    plt.figure(figsize=(10,6))
    plt.imshow(wc, interpolation="bilinear")
    plt.axis("off")
    plt.title(f"Word Cloud - {sentiment}", fontsize=16)
    plt.show()
